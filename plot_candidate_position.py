import matplotlib.pyplot as plt
from astropy.coordinates import SkyCoord
import astropy.units as u


fig, ax = plt.subplots(1, 2, figsize=(10, 5))

#FHRM radius
p2cr = 18.56 / 60. /2.
p1r  =  2.53 / 60. /2.
p2er = p1r / 2

p2c_grid = ['00:36:02.97_-10:35:14.03',
            '00:35:29.12_-10:35:14.03',
            '00:35:46.05_-10:27:25.85',
            '00:36:19.88_-10:27:25.85',
            '00:36:36.81_-10:35:14.03',
            '00:36:19.89_-10:43:02.20',
            '00:35:46.04_-10:43:02.20']

p2c_ras = []
p2c_decs = []
for g in p2c_grid:
    ra, dec = g.split('_')
    p2c_ras.append(ra)
    p2c_decs.append(dec)    

#p2c grid
coord = SkyCoord(p2c_ras, p2c_decs, unit=(u.hourangle,u.deg))
p2c_decs_deg = coord.dec.degree
p2c_ras_deg = coord.ra.degree
for ra, dec in zip(p2c_ras_deg, p2c_decs_deg):
    if ra in [min(p2c_ras_deg), max(p2c_ras_deg)]:
        linewidth = 4
    else:
        linewidth = 1
    circle = plt.Circle((ra, dec), p2cr, color='g', fill=False, linewidth=linewidth )
    ax[0].add_artist(circle)


#p2c posititon estimate
coord = SkyCoord("00:36:14.25", "-10:35:14.03", unit=(u.hourangle,u.deg))
dec_est = coord.dec.degree
ra_est = coord.ra.degree
circle = plt.Circle((ra_est, dec_est), p2cr/2, color='g', alpha=0.5)
ax[0].add_artist(circle)

ax[0].set_ylim(p2c_decs_deg[0]-2*p2cr, p2c_decs_deg[0]+2*p2cr)
ax[0].set_xlim(p2c_ras_deg[0]-2*p2cr, p2c_ras_deg[0]+2*p2cr)
ax[0].set_xlabel("Right Acension (degrees)")
ax[0].set_ylabel("Declination (degrees)")
#plt.gca().set_aspect('equal', adjustable='box')
ax[0].set_aspect('equal', adjustable='box')


#zoom in on the second subplot
circle = plt.Circle((ra_est, dec_est), p2cr/2, color='g', fill=False)
ax[1].add_artist(circle)


"""
p2e_grid = ["00:36:14.25_-10:35:14.03",
"00:36:11.67_-10:35:14.03",
"00:36:12.96_-10:34:38.39",
"00:36:15.53_-10:34:38.39",
"00:36:16.82_-10:35:14.03",
"00:36:15.53_-10:35:49.66",
"00:36:12.96_-10:35:49.66",
"00:36:09.09_-10:35:14.03",
"00:36:10.38_-10:34:38.39",
"00:36:11.67_-10:34:02.75",
"00:36:14.25_-10:34:02.75",
"00:36:16.82_-10:34:02.75",
"00:36:18.11_-10:34:38.39",
"00:36:19.40_-10:35:14.03",
"00:36:18.11_-10:35:49.66",
"00:36:16.82_-10:36:25.29",
"00:36:14.25_-10:36:25.29",
"00:36:11.67_-10:36:25.29",
"00:36:10.38_-10:35:49.66",
"00:36:06.52_-10:35:14.03",
"00:36:07.81_-10:34:38.39",
"00:36:09.09_-10:34:02.75",
"00:36:10.38_-10:33:27.11",
"00:36:12.96_-10:33:27.11",
"00:36:15.53_-10:33:27.11",
"00:36:18.11_-10:33:27.11",
"00:36:19.40_-10:34:02.75",
"00:36:20.68_-10:34:38.39",
"00:36:21.97_-10:35:14.03",
"00:36:20.68_-10:35:49.66",
"00:36:19.40_-10:36:25.29",
"00:36:18.11_-10:37:00.92",
"00:36:15.53_-10:37:00.92",
"00:36:12.96_-10:37:00.92",
"00:36:10.38_-10:37:00.92",
"00:36:09.09_-10:36:25.29",
"00:36:07.81_-10:35:49.66",
"00:36:03.94_-10:35:14.03",
"00:36:05.23_-10:34:38.39",
"00:36:06.52_-10:34:02.75",
"00:36:07.81_-10:33:27.11",
"00:36:09.09_-10:32:51.46",
"00:36:11.67_-10:32:51.46",
"00:36:14.25_-10:32:51.46",
"00:36:16.82_-10:32:51.46",
"00:36:19.40_-10:32:51.46",
"00:36:20.68_-10:33:27.11",
"00:36:21.97_-10:34:02.75",
"00:36:23.26_-10:34:38.39",
"00:36:24.55_-10:35:14.03",
"00:36:23.26_-10:35:49.66",
"00:36:21.97_-10:36:25.29",
"00:36:20.69_-10:37:00.92",
"00:36:19.40_-10:37:36.55",
"00:36:16.82_-10:37:36.55",
"00:36:14.25_-10:37:36.55",
"00:36:11.67_-10:37:36.55",
"00:36:09.09_-10:37:36.55",
"00:36:07.81_-10:37:00.92",
"00:36:06.52_-10:36:25.29",
"00:36:05.23_-10:35:49.66",
"00:36:01.37_-10:35:14.03",
"00:36:02.65_-10:34:38.39",
"00:36:03.94_-10:34:02.75",
"00:36:05.23_-10:33:27.11",
"00:36:06.52_-10:32:51.46",
"00:36:07.81_-10:32:15.81",
"00:36:10.38_-10:32:15.81",
"00:36:12.96_-10:32:15.81",
"00:36:15.53_-10:32:15.81",
"00:36:18.11_-10:32:15.81",
"00:36:20.68_-10:32:15.81",
"00:36:21.97_-10:32:51.46",
"00:36:23.26_-10:33:27.11",
"00:36:24.55_-10:34:02.75",
"00:36:25.84_-10:34:38.39",
"00:36:27.12_-10:35:14.03",
"00:36:25.84_-10:35:49.66",
"00:36:24.55_-10:36:25.29",
"00:36:23.26_-10:37:00.92",
"00:36:21.97_-10:37:36.55",
"00:36:20.69_-10:38:12.17",
"00:36:18.11_-10:38:12.17",
"00:36:15.53_-10:38:12.17",
"00:36:12.96_-10:38:12.17",
"00:36:10.38_-10:38:12.17",
"00:36:07.80_-10:38:12.17",
"00:36:06.52_-10:37:36.55",
"00:36:05.23_-10:37:00.92",
"00:36:03.94_-10:36:25.29",
"00:36:02.65_-10:35:49.66",
"00:35:58.79_-10:35:14.03",
"00:36:00.08_-10:34:38.39",
"00:36:01.37_-10:34:02.75",
"00:36:02.65_-10:33:27.11",
"00:36:03.94_-10:32:51.46",
"00:36:05.23_-10:32:15.81",
"00:36:06.52_-10:31:40.15",
"00:36:09.09_-10:31:40.15",
"00:36:11.67_-10:31:40.15",
"00:36:14.25_-10:31:40.15",
"00:36:16.82_-10:31:40.15",
"00:36:19.40_-10:31:40.15",
"00:36:21.97_-10:31:40.15",
"00:36:23.26_-10:32:15.81",
"00:36:24.55_-10:32:51.46",
"00:36:25.84_-10:33:27.11",
"00:36:27.12_-10:34:02.75",
"00:36:28.41_-10:34:38.39",
"00:36:29.70_-10:35:14.03",
"00:36:28.41_-10:35:49.66",
"00:36:27.13_-10:36:25.29",
"00:36:25.84_-10:37:00.92",
"00:36:24.55_-10:37:36.55",
"00:36:23.26_-10:38:12.17",
"00:36:21.97_-10:38:47.79",
"00:36:19.40_-10:38:47.79",
"00:36:16.82_-10:38:47.79",
"00:36:14.25_-10:38:47.79",
"00:36:11.67_-10:38:47.79",
"00:36:09.09_-10:38:47.79",
"00:36:06.52_-10:38:47.79",
"00:36:05.23_-10:38:12.17",
"00:36:03.94_-10:37:36.55",
"00:36:02.65_-10:37:00.92",
"00:36:01.37_-10:36:25.29",
"00:36:00.08_-10:35:49.66",
"00:35:56.21_-10:35:14.03",
"00:35:57.50_-10:34:38.39",
"00:35:58.79_-10:34:02.75",
"00:36:00.08_-10:33:27.11",
"00:36:01.37_-10:32:51.46",
"00:36:02.66_-10:32:15.81",
"00:36:03.94_-10:31:40.15",
"00:36:05.23_-10:31:04.50",
"00:36:07.81_-10:31:04.50",
"00:36:10.38_-10:31:04.50",
"00:36:12.96_-10:31:04.50",
"00:36:15.53_-10:31:04.50",
"00:36:18.11_-10:31:04.50",
"00:36:20.68_-10:31:04.50",
"00:36:23.26_-10:31:04.50",
"00:36:24.55_-10:31:40.15",
"00:36:25.84_-10:32:15.81",
"00:36:27.12_-10:32:51.46",
"00:36:28.41_-10:33:27.11",
"00:36:29.70_-10:34:02.75",
"00:36:30.99_-10:34:38.39",
"00:36:32.28_-10:35:14.03",
"00:36:30.99_-10:35:49.66",
"00:36:29.70_-10:36:25.29",
"00:36:28.41_-10:37:00.92",
"00:36:27.13_-10:37:36.55",
"00:36:25.84_-10:38:12.17",
"00:36:24.55_-10:38:47.79",
"00:36:23.26_-10:39:23.41",
"00:36:20.69_-10:39:23.41",
"00:36:18.11_-10:39:23.41",
"00:36:15.53_-10:39:23.41",
"00:36:12.96_-10:39:23.41",
"00:36:10.38_-10:39:23.41",
"00:36:07.80_-10:39:23.41",
"00:36:05.23_-10:39:23.41",
"00:36:03.94_-10:38:47.79",
"00:36:02.65_-10:38:12.17",
"00:36:01.37_-10:37:36.55",
"00:36:00.08_-10:37:00.92",
"00:35:58.79_-10:36:25.29",
"00:35:57.50_-10:35:49.66"]

for pos in p2e_grid:
    raj, decj = pos.split("_")
    coord = SkyCoord(raj, decj, unit=(u.hourangle,u.deg))
    dec = coord.dec.degree
    ra = coord.ra.degree
    circle = plt.Circle((ra, dec), p2er, color='b', fill=False, linewidth=0.5)
    ax[1].add_artist(circle)
"""

p1_grid = ["00:36:14.25_-10:35:14.03",
"00:36:09.09_-10:35:14.03",
"00:36:11.67_-10:34:02.75",
"00:36:16.82_-10:34:02.75",
"00:36:19.40_-10:35:14.03",
"00:36:16.82_-10:36:25.30",
"00:36:11.67_-10:36:25.30",
"00:36:03.94_-10:35:14.03",
"00:36:06.52_-10:34:02.75",
"00:36:09.09_-10:32:51.47",
"00:36:14.25_-10:32:51.47",
"00:36:19.40_-10:32:51.47",
"00:36:21.97_-10:34:02.75",
"00:36:24.55_-10:35:14.03",
"00:36:21.97_-10:36:25.30",
"00:36:19.40_-10:37:36.56",
"00:36:14.25_-10:37:36.56",
"00:36:09.09_-10:37:36.56",
"00:36:06.52_-10:36:25.30",
"00:35:58.79_-10:35:14.03",
"00:36:01.37_-10:34:02.75",
"00:36:03.94_-10:32:51.47",
"00:36:06.52_-10:31:40.16",
"00:36:11.67_-10:31:40.16",
"00:36:16.82_-10:31:40.16",
"00:36:21.97_-10:31:40.16",
"00:36:24.55_-10:32:51.47",
"00:36:27.12_-10:34:02.75",
"00:36:29.70_-10:35:14.03",
"00:36:27.13_-10:36:25.30",
"00:36:24.55_-10:37:36.56",
"00:36:21.97_-10:38:47.80",
"00:36:16.82_-10:38:47.80",
"00:36:11.67_-10:38:47.80",
"00:36:06.52_-10:38:47.80",
"00:36:03.94_-10:37:36.56",
"00:36:01.37_-10:36:25.30"]

for pos in p1_grid:
    raj, decj = pos.split("_")
    coord = SkyCoord(raj, decj, unit=(u.hourangle,u.deg))
    dec = coord.dec.degree
    ra = coord.ra.degree
    circle = plt.Circle((ra, dec), p1r, color='r', fill=False, linewidth=0.5)
    ax[1].add_artist(circle)

p2e_grid_final = ["00:36:14.61_-10:33:12.81",
"00:36:12.03_-10:33:12.81",
"00:36:13.32_-10:32:37.16",
"00:36:15.89_-10:32:37.16",
"00:36:17.18_-10:33:12.81",
"00:36:15.89_-10:33:48.45",
"00:36:13.32_-10:33:48.45"]

for pos in p2e_grid_final:
    raj, decj = pos.split("_")
    coord = SkyCoord(raj, decj, unit=(u.hourangle,u.deg))
    dec = coord.dec.degree
    ra = coord.ra.degree
    circle = plt.Circle((ra, dec), p2er, color='b', fill=False, linewidth=0.5)
    ax[1].add_artist(circle)

ax[1].set_ylim(dec_est-p2cr/2, dec_est+p2cr/2)
ax[1].set_xlim(ra_est-p2cr/2, ra_est+p2cr/2)
ax[1].set_xlabel("Right Acension (degrees)")
#ax[1].set_ylabel("Declination (degrees)")
ax[1].yaxis.tick_right()
#ax[1].yaxis.label_right()
ax[1].set_aspect('equal', adjustable='box')
#ax[1].set_xticks(ax[1].get_xticks()[1:-1:2])

coord = SkyCoord("00:36:14.61", "-10:33:42.81", unit=(u.hourangle,u.deg))
dec = coord.dec.degree
ra = coord.ra.degree
circle = plt.Circle((ra, dec), p2er/2, color='b', alpha=0.5)
ax[1].add_artist(circle)

#mark zoomed in subplot
from mpl_toolkits.axes_grid1.inset_locator import mark_inset
mark_inset(ax[0], ax[1], loc1=2, loc2=3, fc="none", ec="0.5", zorder=0.5)

# Move right subplot to the right
#box = ax[1].get_position()
#box.x0 = box.x0 + 0.1
#box.x1 = box.x1 + 0.02
#ax[1].set_position(box)
#plt.tight_layout()
plt.savefig("first_mwa_discovery_localisation.png", dpi=1000)